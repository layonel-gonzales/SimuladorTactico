<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Sistema de Autenticaci√≥n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title">üîê Estado del Sistema de Autenticaci√≥n</h5>
                    </div>
                    <div class="card-body">
                        <h6>Estado de la sesi√≥n:</h6>
                        <p id="session-status" class="text-muted">Verificando...</p>
                        
                        <h6>Elementos del DOM encontrados:</h6>
                        <ul id="dom-elements" class="list-unstyled">
                            <li id="auth-modal-check">‚è≥ Verificando modal de autenticaci√≥n...</li>
                            <li id="auth-overlay-check">‚è≥ Verificando overlay de autenticaci√≥n...</li>
                            <li id="auth-script-check">‚è≥ Verificando script de autenticaci√≥n...</li>
                        </ul>
                        
                        <div class="mt-3">
                            <button class="btn btn-danger btn-sm" onclick="clearSession()">
                                üóëÔ∏è Limpiar Sesi√≥n
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="testAuth()">
                                üîÑ Probar Autenticaci√≥n
                            </button>
                        </div>
                        
                        <div class="mt-3">
                            <a href="index.html" class="btn btn-success">
                                ‚ñ∂Ô∏è Ir a la Aplicaci√≥n Principal
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Verificar estado de la sesi√≥n
        function checkSessionStatus() {
            const isAuthenticated = sessionStorage.getItem('app_authenticated');
            const statusElement = document.getElementById('session-status');
            
            if (isAuthenticated === 'true') {
                statusElement.innerHTML = '<span class="text-success">‚úÖ Sesi√≥n autenticada (se saltar√° el login)</span>';
            } else {
                statusElement.innerHTML = '<span class="text-warning">‚ùå No hay sesi√≥n activa (se pedir√° la clave)</span>';
            }
        }

        // Verificar elementos del DOM
        function checkDOMElements() {
            // Cargar la p√°gina principal para verificar los elementos
            fetch('index.html')
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    
                    // Verificar modal
                    const modalElement = doc.getElementById('auth-modal');
                    document.getElementById('auth-modal-check').innerHTML = modalElement ? 
                        '<span class="text-success">‚úÖ Modal de autenticaci√≥n encontrado</span>' : 
                        '<span class="text-danger">‚ùå Modal de autenticaci√≥n NO encontrado</span>';
                    
                    // Verificar overlay
                    const overlayElement = doc.getElementById('auth-overlay');
                    document.getElementById('auth-overlay-check').innerHTML = overlayElement ? 
                        '<span class="text-success">‚úÖ Overlay de autenticaci√≥n encontrado</span>' : 
                        '<span class="text-danger">‚ùå Overlay de autenticaci√≥n NO encontrado</span>';
                    
                    // Verificar script
                    const scripts = doc.querySelectorAll('script[src*="authSystem.js"]');
                    document.getElementById('auth-script-check').innerHTML = scripts.length > 0 ? 
                        '<span class="text-success">‚úÖ Script de autenticaci√≥n encontrado</span>' : 
                        '<span class="text-danger">‚ùå Script de autenticaci√≥n NO encontrado</span>';
                })
                .catch(error => {
                    document.getElementById('auth-modal-check').innerHTML = '<span class="text-danger">‚ùå Error al verificar elementos</span>';
                    console.error('Error:', error);
                });
        }

        // Limpiar sesi√≥n
        function clearSession() {
            sessionStorage.removeItem('app_authenticated');
            checkSessionStatus();
            alert('‚úÖ Sesi√≥n limpiada. Ahora la aplicaci√≥n pedir√° la clave.');
        }

        // Probar autenticaci√≥n (simular)
        function testAuth() {
            const password = prompt('Introduce la clave de prueba:');
            if (password === 'Anibal2023') {
                sessionStorage.setItem('app_authenticated', 'true');
                alert('‚úÖ Clave correcta. Sesi√≥n activada.');
                checkSessionStatus();
            } else if (password) {
                alert('‚ùå Clave incorrecta.');
            }
        }

        // Inicializar verificaciones
        document.addEventListener('DOMContentLoaded', () => {
            checkSessionStatus();
            checkDOMElements();
        });
    </script>
</body>
</html>
