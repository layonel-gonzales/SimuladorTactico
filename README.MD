# âš½ Simulador TÃ¡ctico de FÃºtbol

Sistema completo de simulaciÃ³n tÃ¡ctica de fÃºtbol con funcionalidades avanzadas de dibujo, animaciÃ³n y sistema freemium de autenticaciÃ³n.

## ğŸš€ Inicio RÃ¡pido

### InstalaciÃ³n
```bash
npm install
npm start
```

### Acceso al Sistema
- **AplicaciÃ³n Principal**: http://localhost:3000
- **Login Premium**: http://localhost:3000/login.html
- **Usuario de Prueba**: `test@simulador.com` / `password123`

## ğŸ® Funcionalidades Principales

### âš½ Simulador TÃ¡ctico Interactivo
- **Campo de fÃºtbol HTML5 Canvas** con jugadores movibles
- **Dos modos principales:**
  - ğŸ¨ **Modo Dibujo**: LÃ­neas, flechas, diagramas tÃ¡cticos
  - ğŸ¬ **Modo AnimaciÃ³n**: Secuencias de movimiento con audio

### ğŸ¨ Herramientas de Dibujo
- âœ… **LÃ­neas personalizables** (color, grosor)
- âœ… **Borrador selectivo** (eliminar lÃ­neas especÃ­ficas)
- âœ… **Deshacer/Rehacer** con historial completo
- âœ… **Limpieza completa** del canvas
- âœ… **Paleta de colores** extendida
- âœ… **Compartir como imagen** (PNG/JPG)

### ğŸ¬ Sistema de AnimaciÃ³n Avanzado
- âœ… **CreaciÃ³n de frames secuenciales** de movimiento
- âœ… **ReproducciÃ³n fluida** de animaciones
- âœ… **GrabaciÃ³n de audio/narraciÃ³n** sincronizada
- âœ… **ExportaciÃ³n a video MP4** con audio
- âœ… **ExportaciÃ³n/ImportaciÃ³n JSON** completa
- âœ… **Controles de reproducciÃ³n** (play, pause, velocidad)

### ğŸ‘¥ GestiÃ³n Completa de Jugadores
- âœ… **Plantillas predefinidas** (mÃºltiples formaciones)
- âœ… **Jugadores personalizados** con editor completo
- âœ… **Tarjetas de jugador** con foto y estadÃ­sticas
- âœ… **Formaciones tÃ¡cticas** (4-4-2, 4-3-3, etc.)
- âœ… **Drag & Drop** para mover jugadores
- âœ… **Filtros por equipo y posiciÃ³n**

### ğŸ“ Sistema Tutorial Interactivo
- âœ… **Tutorial paso a paso** para modo dibujo (7 pasos)
- âœ… **Tutorial completo** para modo animaciÃ³n (12 pasos)
- âœ… **Tooltips profesionales** con posicionamiento inteligente
- âœ… **Overlay selectivo** que preserva visibilidad del menÃº
- âœ… **NavegaciÃ³n fluida** entre pasos

### ğŸ”§ ConfiguraciÃ³n Avanzada
- âœ… **Panel de configuraciÃ³n** completo con 6 categorÃ­as
- âœ… **Temas visual** (claro/oscuro/automÃ¡tico)
- âœ… **Colores de acento** personalizables
- âœ… **Modo compacto** para interfaces pequeÃ±as
- âœ… **Alto contraste** para accesibilidad
- âœ… **ConfirmaciÃ³n de acciones** configurable

### ğŸ“± CaracterÃ­sticas Premium
- âœ… **Sistema de autenticaciÃ³n JWT** con Node.js/Express
- âœ… **Control de dispositivos** (mÃ¡ximo 3 por usuario premium)
- âœ… **Base de datos de usuarios** con bcrypt
- âœ… **IntegraciÃ³n con Stripe** para pagos
- âœ… **Rate limiting** y seguridad avanzada

## ğŸ› ï¸ TecnologÃ­as y LibrerÃ­as

### Frontend
- **HTML5 Canvas** - Renderizado del campo y dibujo
- **Bootstrap 5** - Framework CSS responsivo
- **JavaScript ES6+** - LÃ³gica de aplicaciÃ³n modular
- **Font Awesome** - IconografÃ­a completa
- **Web Audio API** - GrabaciÃ³n y reproducciÃ³n de audio
- **MediaRecorder API** - Captura de video del canvas
- **Shepherd.js Custom** - Sistema tutorial personalizado

### Backend
- **Node.js** - Runtime del servidor
- **Express.js** - Framework web
- **JSON Web Tokens (JWT)** - AutenticaciÃ³n
- **bcrypt** - Hash de contraseÃ±as
- **Stripe** - Procesamiento de pagos
- **CORS** - Control de acceso cross-origin
- **Express Rate Limit** - Control de tasa de peticiones
- **UUID** - GeneraciÃ³n de identificadores Ãºnicos

### Base de Datos
- **En memoria (Map)** - Para desarrollo
- **Preparado para MongoDB/PostgreSQL** - Para producciÃ³n

## ğŸ“ Estructura del Proyecto

```
ğŸ“¦ SimuladorTactico/
â”œâ”€â”€ ğŸ“‚ server/
â”‚   â”œâ”€â”€ freemium-server.js       # Servidor principal con autenticaciÃ³n
â”‚   â””â”€â”€ license-server.js        # Servidor de licencias (backup)
â”œâ”€â”€ ğŸ“‚ js/
â”‚   â”œâ”€â”€ main.js                  # Punto de entrada principal
â”‚   â”œâ”€â”€ animationManager.js      # Sistema completo de animaciones
â”‚   â”œâ”€â”€ drawingManager.js        # Herramientas de dibujo
â”‚   â”œâ”€â”€ playerManager.js         # GestiÃ³n de jugadores
â”‚   â”œâ”€â”€ uiManager.js             # Interfaz de usuario
â”‚   â”œâ”€â”€ modeManager.js           # Coordinador de modos
â”‚   â”œâ”€â”€ tutorialManager.js       # Sistema tutorial personalizado
â”‚   â”œâ”€â”€ configurationUI.js      # Panel de configuraciÃ³n
â”‚   â”œâ”€â”€ customPlayersManager.js  # Jugadores personalizados
â”‚   â”œâ”€â”€ audioManager.js          # GrabaciÃ³n de audio
â”‚   â”œâ”€â”€ shareManager.js          # ExportaciÃ³n y compartir
â”‚   â”œâ”€â”€ fieldDrawer.js           # Renderizado del campo
â”‚   â”œâ”€â”€ ballDrawingManager.js    # Dibujo con estela del balÃ³n
â”‚   â”œâ”€â”€ freemiumAuthSystem-simple.js # AutenticaciÃ³n frontend
â”‚   â”œâ”€â”€ paymentManager.js        # GestiÃ³n de pagos Stripe
â”‚   â”œâ”€â”€ fullscreenManager.js     # Pantalla completa
â”‚   â”œâ”€â”€ orientationManager.js    # Manejo de orientaciÃ³n mÃ³vil
â”‚   â”œâ”€â”€ themeManager.js          # GestiÃ³n de temas
â”‚   â”œâ”€â”€ deviceIdManager.js       # Control de dispositivos
â”‚   â””â”€â”€ libs/
â”‚       â””â”€â”€ simple-tutorial.js   # Tutorial personalizado (300+ lÃ­neas)
â”œâ”€â”€ ğŸ“‚ css/
â”‚   â””â”€â”€ estilo.css               # Estilos principales unificados
â”œâ”€â”€ ğŸ“‚ img/                      # Recursos grÃ¡ficos
â”œâ”€â”€ ğŸ“„ index.html                # AplicaciÃ³n principal
â”œâ”€â”€ ğŸ“„ login.html                # PÃ¡gina de autenticaciÃ³n premium
â”œâ”€â”€ ğŸ“„ package.json              # Dependencias del proyecto
â””â”€â”€ ğŸ“„ .env                      # Variables de entorno
```

## ğŸ”‘ Flujo del Sistema

### 1. AutenticaciÃ³n (login.html)
```
Usuario accede â†’ VerificaciÃ³n de credenciales â†’ JWT Token â†’ RedirecciÃ³n a index.html
```
- **Frontend**: Formulario de login con validaciÃ³n
- **Backend**: VerificaciÃ³n bcrypt + generaciÃ³n JWT
- **Control de dispositivos**: MÃ¡ximo 3 dispositivos por usuario premium
- **Rate limiting**: ProtecciÃ³n contra ataques de fuerza bruta

### 2. AplicaciÃ³n Principal (index.html)
```
Carga inicial â†’ VerificaciÃ³n JWT â†’ InicializaciÃ³n de mÃ³dulos â†’ Tutorial (primera vez)
```
- **VerificaciÃ³n automÃ¡tica** de autenticaciÃ³n al cargar
- **InicializaciÃ³n modular** de todos los gestores
- **Tutorial automÃ¡tico** para nuevos usuarios
- **Interfaz responsiva** con orientaciÃ³n mÃ³vil

### 3. Modos de OperaciÃ³n

#### ğŸ¨ Modo Dibujo
```
Seleccionar jugadores â†’ Dibujar lÃ­neas tÃ¡cticas â†’ Configurar herramientas â†’ Exportar
```
- **Tutorial de 7 pasos**: Deshacer â†’ Rehacer â†’ Limpiar â†’ Color â†’ Grosor â†’ Borrar â†’ Compartir
- **Herramientas avanzadas**: Paleta de colores, grosores variables, borrador selectivo
- **ExportaciÃ³n**: PNG/JPG con opciones de calidad

#### ğŸ¬ Modo AnimaciÃ³n
```
Grabar movimientos â†’ Crear frames â†’ Agregar audio â†’ Reproducir â†’ Exportar video
```
- **Tutorial de 12 pasos**: Grabar â†’ Nuevo Frame â†’ NavegaciÃ³n â†’ Reproducir â†’ Audio â†’ Exportar
- **Sistema de frames**: NavegaciÃ³n fluida, indicador de posiciÃ³n
- **Audio sincronizado**: GrabaciÃ³n y reproducciÃ³n con la animaciÃ³n
- **ExportaciÃ³n mÃºltiple**: MP4, JSON para reutilizaciÃ³n

## ğŸ“Š API Endpoints

### AutenticaciÃ³n
- `POST /api/auth/register` - Registro de nuevo usuario
- `POST /api/auth/login` - Inicio de sesiÃ³n
- `GET /api/user/status` - Estado del usuario actual

### Dispositivos
- `GET /api/devices` - Lista de dispositivos del usuario
- `DELETE /api/devices/:deviceId` - Desvincular dispositivo

### Pagos (Stripe)
- `POST /api/stripe/create-checkout-session` - Crear sesiÃ³n de pago
- `POST /api/stripe/webhook` - Webhook de Stripe para confirmaciones

### Salud del Sistema
- `GET /api/health` - Estado del servidor y estadÃ­sticas

## ğŸ¯ CaracterÃ­sticas TÃ©cnicas Avanzadas

### Sistema Tutorial Personalizado
- **SimpleTutorial.js** - 300+ lÃ­neas de cÃ³digo personalizado
- **Overlay inteligente** que calcula altura del menÃº dinÃ¡micamente
- **Posicionamiento adaptativo** de tooltips
- **NavegaciÃ³n fluida** con historial

### GestiÃ³n de Estados
- **ModeManager** - CoordinaciÃ³n entre modo dibujo y animaciÃ³n
- **ConfigurationManager** - Persistencia de configuraciones en localStorage
- **PlayerManager** - Estado de jugadores y formaciones

### Optimizaciones de Rendimiento
- **Throttled events** para resize y orientaciÃ³n
- **Lazy loading** de componentes pesados
- **Canvas optimization** para dibujo fluido
- **Memory management** para grabaciÃ³n de audio/video

### Seguridad
- **JWT con expiraciÃ³n** (7 dÃ­as)
- **Hash bcrypt** para contraseÃ±as
- **Rate limiting** (100 requests/15min)
- **CORS configurado** para dominios especÃ­ficos
- **ValidaciÃ³n de entrada** en todos los endpoints

## ğŸš€ Despliegue

### Desarrollo
```bash
npm install
npm run dev  # Con nodemon para auto-reload
```

### ProducciÃ³n
```bash
npm run build-production  # MinificaciÃ³n y ofuscaciÃ³n
npm start
```

### Variables de Entorno (.env)
```env
PORT=3000
JWT_SECRET=tu_jwt_secret_aqui
STRIPE_SECRET_KEY=sk_test_tu_clave_stripe
STRIPE_WEBHOOK_SECRET=whsec_tu_webhook_secret
NODE_ENV=production
```

---

**âœ… Sistema completamente funcional con todas las caracterÃ­sticas implementadas y documentadas**
